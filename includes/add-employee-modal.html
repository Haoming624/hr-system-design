<!-- Add Employee Modal -->
<div class="modal fade" id="addEmployeeModal" tabindex="-1" aria-labelledby="addEmployeeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="addEmployeeModalLabel">Add New Employee</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form id="addEmployeeForm">
        <div class="modal-body p-4">
          <div class="row g-3">
            <!-- Basic Information -->
            <div class="col-12">
              <h6 class="text-primary mb-3"><i class="bi bi-person me-2"></i>Basic Information</h6>
            </div>
            <div class="col-md-3">
              <label class="form-label">Title</label>
              <select class="form-select" name="title">
                <option value="">Select Title</option>
                <option value="mr">Mr</option>
                <option value="mrs">Mrs</option>
                <option value="ms">Ms</option>
                <option value="dr">Dr</option>
              </select>
            </div>
            <div class="col-md-3">
              <label class="form-label">First Name <span class="text-danger">*</span></label>
              <input type="text" class="form-control" name="first_name" placeholder="Enter first name" required>
            </div>
            <div class="col-md-3">
              <label class="form-label">Middle Name</label>
              <input type="text" class="form-control" name="middle_name" placeholder="Enter middle name">
            </div>
            <div class="col-md-3">
              <label class="form-label">Surname <span class="text-danger">*</span></label>
              <input type="text" class="form-control" name="surname" placeholder="Enter surname" required>
            </div>
            <div class="col-md-3">
              <label class="form-label">Known As</label>
              <input type="text" class="form-control" name="known_as" placeholder="Preferred name">
            </div>
            <div class="col-md-3">
              <label class="form-label">Gender</label>
              <select class="form-select" name="gender">
                <option value="">Select Gender</option>
                <option value="male">Male</option>
                <option value="female">Female</option>
                <option value="other">Other</option>
              </select>
            </div>
            <div class="col-md-3">
              <label class="form-label">Date of Birth <span class="text-danger">*</span></label>
              <input type="date" class="form-control" name="date_of_birth" required>
            </div>
            <div class="col-md-3">
              <label class="form-label">Nationality <span class="text-danger">*</span></label>
              <select class="form-select" name="nationality" required>
                <option value="">Select Nationality</option>
                <option value="uk">United Kingdom</option>
                <option value="us">United States</option>
                <option value="de">Germany</option>
                <option value="fr">France</option>
                <option value="it">Italy</option>
                <option value="es">Spain</option>
              </select>
            </div>
            
            <!-- Contact Information -->
            <div class="col-12">
              <h6 class="text-primary mb-3 mt-4"><i class="bi bi-telephone me-2"></i>Contact Information</h6>
            </div>
            <div class="col-md-6">
              <label class="form-label">Work Email <span class="text-danger">*</span></label>
              <input type="email" class="form-control" name="email_address" placeholder="Enter work email" required>
            </div>
            <div class="col-md-6">
              <label class="form-label">Personal Email</label>
              <input type="email" class="form-control" name="personal_email" placeholder="Enter personal email">
            </div>
            <div class="col-md-4">
              <label class="form-label">Personal Mobile <span class="text-danger">*</span></label>
              <input type="tel" class="form-control" name="personal_mobile" placeholder="Enter personal mobile" required>
            </div>
            <div class="col-md-4">
              <label class="form-label">Work Mobile</label>
              <input type="tel" class="form-control" name="work_mobile" placeholder="Enter work mobile">
            </div>
            <div class="col-md-4">
              <label class="form-label">Home Telephone</label>
              <input type="tel" class="form-control" name="home_telephone" placeholder="Enter home phone">
            </div>
            
            <!-- Address Information -->
            <div class="col-12">
              <h6 class="text-primary mb-3 mt-4"><i class="bi bi-geo-alt me-2"></i>Address Information</h6>
            </div>
            <div class="col-md-12">
              <label class="form-label">Address Line 1 <span class="text-danger">*</span></label>
              <input type="text" class="form-control" name="address_line_1" placeholder="Enter address line 1" required>
            </div>
            <div class="col-md-6">
              <label class="form-label">Address Line 2</label>
              <input type="text" class="form-control" name="address_line_2" placeholder="Enter address line 2">
            </div>
            <div class="col-md-6">
              <label class="form-label">Address Line 3</label>
              <input type="text" class="form-control" name="address_line_3" placeholder="Enter address line 3">
            </div>
            <div class="col-md-4">
              <label class="form-label">City <span class="text-danger">*</span></label>
              <input type="text" class="form-control" name="city" placeholder="Enter city" required>
            </div>
            <div class="col-md-4">
              <label class="form-label">County</label>
              <input type="text" class="form-control" name="county" placeholder="Enter county">
            </div>
            <div class="col-md-4">
              <label class="form-label">Post Code <span class="text-danger">*</span></label>
              <input type="text" class="form-control" name="post_code" placeholder="Enter post code" required>
            </div>
            <div class="col-md-6">
              <label class="form-label">Country</label>
              <select class="form-select" name="country">
                <option value="uk" selected>United Kingdom</option>
                <option value="us">United States</option>
                <option value="de">Germany</option>
                <option value="fr">France</option>
                <option value="it">Italy</option>
                <option value="es">Spain</option>
              </select>
              <small class="text-muted">Default to current company country</small>
            </div>
            
            <!-- Employment Details -->
            <div class="col-12">
              <h6 class="text-primary mb-3 mt-4"><i class="bi bi-briefcase me-2"></i>Employment Details</h6>
            </div>
            <div class="col-md-6">
              <label class="form-label">Staff ID <span class="text-danger">*</span></label>
              <input type="text" class="form-control" name="staff_id" placeholder="Enter staff ID" required>
            </div>
            <div class="col-md-6">
              <label class="form-label">Company ID</label>
              <input type="text" class="form-control" name="company_id" value="COMP001" readonly>
              <small class="text-muted">Auto-assigned to current company</small>
            </div>
            <div class="col-md-6">
              <label class="form-label">Payroll Number <span class="text-danger">*</span></label>
              <input type="number" class="form-control" name="payroll_no" placeholder="Enter payroll number" required>
            </div>
            <div class="col-md-6">
              <label class="form-label">Employment Status <span class="text-danger">*</span></label>
              <select class="form-select" name="status" required>
                <option value="">Select status</option>
                <option value="active">Active</option>
                <option value="resigned">Resigned</option>
                <option value="terminated">Terminated</option>
                <option value="laid_off">Laid Off</option>
                <option value="retired">Retired</option>
              </select>
            </div>
            <div class="col-md-6">
              <label class="form-label">Department & Group <span class="text-danger">*</span></label>
              <div class="row g-2">
                <div class="col-6">
                  <select class="form-select" id="departmentSelect" name="department_id" required>
                    <option value="">Select Department</option>
                    <option value="hr">Human Resources</option>
                    <option value="finance">Finance</option>
                    <option value="it">IT</option>
                    <option value="operations">Operations</option>
                    <option value="marketing">Marketing</option>
                    <option value="sales">Sales</option>
                  </select>
                </div>
                <div class="col-6">
                  <select class="form-select" id="groupSelect" name="group_id" required disabled>
                    <option value="">Select Group</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <label class="form-label">Job Title & Grade <span class="text-danger">*</span></label>
              <div class="row g-2">
                <div class="col-6">
                  <select class="form-select" id="jobTitleSelect" name="job_title_id" required disabled>
                    <option value="">Select Job Title</option>
                  </select>
                </div>
                <div class="col-6">
                  <select class="form-select" id="gradeSelect" name="grading_id" required disabled>
                    <option value="">Select Grade</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <label class="form-label">Work Location <span class="text-danger">*</span></label>
              <select class="form-select" name="work_location_id" required>
                <option value="">Select Work Location</option>
                <option value="london">London Office</option>
                <option value="manchester">Manchester Office</option>
                <option value="remote">Remote</option>
                <option value="hybrid">Hybrid</option>
              </select>
            </div>
            <div class="col-md-4">
              <label class="form-label">Work Type <span class="text-danger">*</span></label>
              <select class="form-select" name="work_type_id" required>
                <option value="">Select Work Type</option>
                <option value="full_time">Full-time</option>
                <option value="part_time">Part-time</option>
                <option value="contract">Contract</option>
                <option value="temporary">Temporary</option>
              </select>
            </div>
            <div class="col-md-4">
              <label class="form-label">Join Date <span class="text-danger">*</span></label>
              <input type="date" class="form-control" name="join_date" required>
            </div>
            <div class="col-md-4">
              <label class="form-label">Probation Date</label>
              <input type="date" class="form-control" name="probation_date">
            </div>
            <div class="col-md-4">
              <label class="form-label">Contract Expiry Date</label>
              <input type="date" class="form-control" name="contract_expiry_date">
            </div>
            <div class="col-md-4">
              <label class="form-label">Weekly Working Hours <span class="text-danger">*</span></label>
              <input type="number" class="form-control" name="weekly_working_hours" step="0.5" placeholder="e.g., 37.5" required>
            </div>
            
            <!-- Compensation Information -->
            <div class="col-12">
              <h6 class="text-primary mb-3 mt-4"><i class="bi bi-cash me-2"></i>Compensation Information</h6>
            </div>
            <div class="col-md-4">
              <label class="form-label">Salary Amount <span class="text-danger">*</span></label>
              <input type="number" class="form-control" name="pay_amount" step="0.01" placeholder="Enter salary amount" required>
            </div>
            <div class="col-md-4">
              <label class="form-label">Currency <span class="text-danger">*</span></label>
              <select class="form-select" name="currency" required>
                <option value="gbp">GBP</option>
                <option value="usd">USD</option>
                <option value="eur">EUR</option>
              </select>
            </div>
            <div class="col-md-4">
              <label class="form-label">Pay Frequency <span class="text-danger">*</span></label>
              <select class="form-select" name="pay_frequency" required>
                <option value="">Select Pay Frequency</option>
                <option value="hourly">Hourly</option>
                <option value="weekly">Weekly</option>
                <option value="monthly">Monthly</option>
                <option value="quarterly">Quarterly</option>
                <option value="contract">Contract</option>
              </select>
            </div>

            
            <!-- National ID Information -->
            <div class="col-12">
              <h6 class="text-primary mb-3 mt-4"><i class="bi bi-card-text me-2"></i>National ID Information</h6>
            </div>
            <div class="col-md-6">
              <label class="form-label">National ID Type</label>
              <select class="form-select" name="national_id_type">
                <option value="nino" selected>NINO (UK)</option>
                <option value="ssn">SSN (US)</option>
                <option value="bsn">BSN (Netherlands)</option>
                <option value="ppsn">PPSN (Ireland)</option>
                <option value="passport">Passport</option>
                <option value="driving_license">Driving License</option>
              </select>
              <small class="text-muted">Default to current country ID type</small>
            </div>
            <div class="col-md-6">
              <label class="form-label">National ID Number <span class="text-danger">*</span></label>
              <input type="text" class="form-control" name="national_id_number" placeholder="Enter ID number" required>
            </div>
            
            <!-- Emergency Contact -->
            <div class="col-12">
              <h6 class="text-primary mb-3 mt-4"><i class="bi bi-person-plus me-2"></i>Emergency Contact</h6>
            </div>
            <div class="col-md-4">
              <label class="form-label">Contact Name <span class="text-danger">*</span></label>
              <input type="text" class="form-control" name="emergency_contact_name" placeholder="Enter contact name" required>
            </div>
            <div class="col-md-4">
              <label class="form-label">Relationship <span class="text-danger">*</span></label>
              <select class="form-select" name="emergency_contact_relationship" required>
                <option value="">Select Relationship</option>
                <option value="spouse">Spouse</option>
                <option value="parent">Parent</option>
                <option value="sibling">Sibling</option>
                <option value="friend">Friend</option>
                <option value="other">Other</option>
              </select>
            </div>
            <div class="col-md-4">
              <label class="form-label">Contact Phone <span class="text-danger">*</span></label>
              <input type="tel" class="form-control" name="emergency_contact_phone" placeholder="Enter contact phone" required>
            </div>
            
            <!-- Remarks -->
            <div class="col-12">
              <label class="form-label">Remarks</label>
              <textarea class="form-control" name="remarks" rows="3" placeholder="Enter any additional remarks"></textarea>
            </div>
            
            <div class="col-12">
              <div class="alert alert-info">
                <i class="bi bi-info-circle me-2"></i>
                <strong>Note:</strong> Additional employee information can be completed in the employee profile after creation.
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer border-0 pt-0">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-primary">
            Create Employee
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
// Nested dropdown functionality
const departmentData = {
  'hr': ['Payroll Team', 'Recruitment Team', 'HR Admin Team'],
  'finance': ['Accounting Team', 'Budget Team', 'Financial Planning Team'],
  'it': ['Support Team', 'Development Team', 'Infrastructure Team'],
  'operations': ['Logistics Team', 'Quality Team', 'Production Team'],
  'marketing': ['Digital Marketing Team', 'Content Team', 'Brand Team'],
  'sales': ['Sales Team', 'Account Management Team', 'Business Development Team']
};

const jobTitleData = {
  'hr': ['HR Manager', 'HR Officer', 'HR Assistant', 'Recruitment Specialist', 'Payroll Officer'],
  'finance': ['Finance Director', 'Finance Officer', 'Accountant', 'Financial Analyst', 'Payroll Manager'],
  'it': ['IT Manager', 'IT Support Specialist', 'Software Developer', 'System Administrator', 'Network Engineer'],
  'operations': ['Operations Manager', 'Operations Specialist', 'Logistics Coordinator', 'Quality Assurance'],
  'marketing': ['Marketing Manager', 'Marketing Specialist', 'Digital Marketing Specialist', 'Content Creator'],
  'sales': ['Sales Manager', 'Sales Representative', 'Account Manager', 'Business Development']
};



// Use event delegation for modal elements
document.addEventListener('change', function(e) {
  // Department-Group nested dropdown
  if (e.target.id === 'departmentSelect') {
    const groupSelect = document.getElementById('groupSelect');
    const jobTitleSelect = document.getElementById('jobTitleSelect');
    const gradeSelect = document.getElementById('gradeSelect');
    const selectedDepartment = e.target.value;
    
    // Reset all dependent dropdowns
    groupSelect.innerHTML = '<option value="">Select Group</option>';
    groupSelect.disabled = true;
    
    jobTitleSelect.innerHTML = '<option value="">Select Job Title</option>';
    jobTitleSelect.disabled = true;
    
    gradeSelect.innerHTML = '<option value="">Select Grade</option>';
    gradeSelect.disabled = true;
    
    // Enable and populate group dropdown if department is selected
    if (selectedDepartment && departmentData[selectedDepartment]) {
      departmentData[selectedDepartment].forEach(group => {
        const option = document.createElement('option');
        option.value = group.toLowerCase().replace(/\s+/g, '-');
        option.textContent = group;
        groupSelect.appendChild(option);
      });
      groupSelect.disabled = false;
    }
    
    // Enable and populate job title dropdown if department is selected
    if (selectedDepartment && jobTitleData[selectedDepartment]) {
      jobTitleData[selectedDepartment].forEach(jobTitle => {
        const option = document.createElement('option');
        option.value = jobTitle.toLowerCase().replace(/\s+/g, '-');
        option.textContent = jobTitle;
        jobTitleSelect.appendChild(option);
      });
      jobTitleSelect.disabled = false;
    }
  }
  
  // Job Title-Grade nested dropdown
  if (e.target.id === 'jobTitleSelect') {
    const gradeSelect = document.getElementById('gradeSelect');
    const selectedJobTitle = e.target.value;
    
    // Reset grade dropdown
    gradeSelect.innerHTML = '<option value="">Select Grade</option>';
    gradeSelect.disabled = true;
    
    // Enable and populate grade dropdown if job title is selected
    if (selectedJobTitle) {
      // Standard grades for all job titles
      const grades = ['A', 'B', 'C', 'None'];
      grades.forEach(grade => {
        const option = document.createElement('option');
        option.value = grade.toLowerCase();
        option.textContent = grade;
        gradeSelect.appendChild(option);
      });
      gradeSelect.disabled = false;
    }
  }
});



// Form submission with data collection
document.getElementById('addEmployeeForm').addEventListener('submit', function(e) {
  e.preventDefault();
  
  // Collect form data
  const formData = new FormData(this);
  const employeeData = {};
  
  for (let [key, value] of formData.entries()) {
    if (value) {
      employeeData[key] = value;
    }
  }
  
  // Add status for optional files (based on database structure)
  employeeData.status = 'active'; // Default status for new employees
  
  // Here you would typically send the data to your API
  // For now, we'll just redirect to the profile page
  window.location.href = 'employee-profile.html';
});

// Auto-populate probation date (3 months from join date)
document.querySelector('input[name="join_date"]').addEventListener('change', function() {
  const joinDate = new Date(this.value);
  const probationDate = new Date(joinDate);
  probationDate.setMonth(probationDate.getMonth() + 3);
  
  const probationInput = document.querySelector('input[name="probation_date"]');
  probationInput.value = probationDate.toISOString().split('T')[0];
});

// Auto-populate contract expiry date (1 year from join date)
document.querySelector('input[name="join_date"]').addEventListener('change', function() {
  const joinDate = new Date(this.value);
  const expiryDate = new Date(joinDate);
  expiryDate.setFullYear(expiryDate.getFullYear() + 1);
  
  const expiryInput = document.querySelector('input[name="contract_expiry_date"]');
  expiryInput.value = expiryDate.toISOString().split('T')[0];
});
</script> 